<div class="row"></div>
<script>
miners();
$(document).ready(function(){
	socket.onmessage = function(event) {
	  message = event.data;
      obj = JSON.parse(message);
        divname = "#" + obj.id;
        toteth = obj.result[2];
        splittoteth = toteth.split(";");
        //VGA SEGRAGATION
        gpus = obj.result[3].split(";");
        //TEMP and FAN SEGRAGATION
        tempfan = obj.result[6].split(";");
        totethhas = (splittoteth[0] / 1000).toFixed(3) + " MH/s";
        toteth = (splittoteth[0] / 1000).toFixed(3);
        totsia = obj.result[4];
        splittosia = totsia.split(";");
        totsiahash = (splittosia[0]/1000).toFixed(3) + " MH/s";
        if ($(divname).length == 0 ){
            $(".row").append("    <div id='"+obj.id+"' class='col s12 m6'>"
                            +"      <div class='card blue-grey darken-1 hoverable'>"
                            +"        <div class='card-content white-text'>"
                            +"          <span class='card-title'>Miner: "+obj.id+"</span>"
                            +"          <p>Running version: "+obj.result[0]+"</p><br>"
                            +"          <p>Total Hash Rate: "+totethhas+"</p><br>"
                            +"          <p>GPU1: "+(gpus[0]/1000).toFixed(3)+"MH/s, GPU2: "+(gpus[1]/1000).toFixed(3)+"MH/s, GPU3: "+(gpus[2]/1000).toFixed(3)+"MH/s, GPU4: "+(gpus[3]/1000).toFixed(3)+"MH/s, GPU5: "+(gpus[4]/1000).toFixed(3)+"MH/s, GPU6: "+(gpus[5]/1000).toFixed(3)+" MH/s</p><br>"
                            +"          <p>Total Number of Shares: "+splittoteth[1]+"</p><span>Rejected: "+splittoteth[2]+"<br>"
                            +"          <p>Total Sia Rate: "+totsiahash+"</p><br>"
                            +"          <p>Total Sia Shares: "+splittosia[1]+"</p><span>Rejected: "+splittosia[2]+"<br>"
                            +"        </div>"
                            +"        <div class='card-action'>"
                            +"          <a href='#'>This is a link</a>"
                            +"          <a href='#'>This is a link</a>"
                            +"        </div>"
                            +"      </div>"
                            +"    </div>");
        } else {
           $(divname).replaceWith("    <div id='"+obj.id+"' class='col s12 m6'>"
                            +"      <div class='card blue-grey darken-1 hoverable'>"
                            +"        <div class='card-content white-text'>"
                            +"          <span class='card-title'>Miner: "+obj.id+"</span>"
                            +"          <p>Running version: "+obj.result[0]+"</p><br>"
                            +"          <p>Total Hash Rate: "+totethhas+"</p><br>"
                            +"          <p>GPU1: "+(gpus[0]/1000).toFixed(3)+"MH/s, GPU2: "+(gpus[1]/1000).toFixed(3)+"MH/s, GPU3: "+(gpus[2]/1000).toFixed(3)+"MH/s, GPU4: "+(gpus[3]/1000).toFixed(3)+"MH/s, GPU5: "+(gpus[4]/1000).toFixed(3)+"MH/s, GPU6: "+(gpus[5]/1000).toFixed(3)+" MH/s</p><br>"
                            +"          <p>Total Number of Shares: "+splittoteth[1]+"</p><span>Rejected: "+splittoteth[2]+"<br>"
                            +"          <p>Total Sia Rate: "+totsiahash+"</p><br>"
                            +"          <p>Total Sia Shares: "+splittosia[1]+"</p><span>Rejected: "+splittosia[2]+"<br>"
                            +"        </div>"
                            +"        <div class='card-action'>"
                            +"          <a href='#'>This is a link</a>"
                            +"          <a href='#'>This is a link</a>"
                            +"        </div>"
                            +"      </div>"
                            +"    </div>");
        }
	 //HERE
    gpucount = 0;
    };
});
</script>